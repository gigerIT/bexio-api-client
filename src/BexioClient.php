<?php
declare(strict_types=1);


namespace Bexio;

use Saloon\Http\Auth\TokenAuthenticator;
use Saloon\Http\Connector;
use Saloon\Traits\Body\HasJsonBody;
use Saloon\Traits\Plugins\AcceptsJson;
use Saloon\Traits\Plugins\AlwaysThrowOnErrors;

class BexioClient extends Connector
{
    use AlwaysThrowOnErrors;
    use AcceptsJson;
    use HasJsonBody;

    const PUBLIC_TEST_API_KEY = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJkVTNTYXFLOHF1c25rakl4WEFsbE1EZk0zakRLYkJneDd3dlVVMHBsaUhFIn0.eyJleHAiOjE3NTE5NzA1MDEsImlhdCI6MTczNjE1OTMwMiwianRpIjoiZjNjNjJkY2MtNjNiZC00M2YzLTk0MzYtYzQ1YmVjNTA0ZTIyIiwiaXNzIjoiaHR0cHM6Ly9hdXRoLmJleGlvLmNvbS9yZWFsbXMvYmV4aW8iLCJzdWIiOiI4ZTIwMzk2NC1hYTY5LTRhNDQtOTM4ZS05NDFkOTA2NjI1NDkiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJiZXhpb19wYXRfcHJvdmlkZXIiLCJzaWQiOiIzMTg1ODNlZC02NWFhLTRhNmQtOGIxYy1mOGRhMDJjMDNhYTMiLCJzY29wZSI6Im9wZW5pZCBwYXlyb2xsX2VtcGxveWVlX3Nob3cgbW9uaXRvcmluZ19zaG93IGtiX2ludm9pY2VfZWRpdCBrYl9jcmVkaXRfdm91Y2hlcl9zaG93IHRhc2tfc2hvdyBwYXlyb2xsX3RpbWVfYWNjb3VudF9zaG93IGNvbnRhY3Rfc2hvdyBwcm9maWxlIGtiX29mZmVyX2VkaXQgZW1haWwgY29tcGFueV9wcm9maWxlIGFjY291bnRpbmcgcGF5cm9sbF90aW1lX2FjY291bnRfZWRpdCBvZmZsaW5lX2FjY2VzcyB0ZWNobmljYWwga2Jfb2ZmZXJfc2hvdyBwYXlyb2xsX2Fic2VuY2VfZWRpdCByZXZvY2FibGUga2JfYXJ0aWNsZV9vcmRlcl9zaG93IHBheXJvbGxfcGF5c3R1Yl9zaG93IGJhbmtfYWNjb3VudF9zaG93IHByb2plY3RfZWRpdCBrYl9jcmVkaXRfdm91Y2hlcl9lZGl0IGtiX2JpbGxfc2hvdyBrYl9leHBlbnNlX2VkaXQga2JfaW52b2ljZV9zaG93IGJhbmtfcGF5bWVudF9lZGl0IGZpbGUgbW9uaXRvcmluZ19lZGl0IGtiX29yZGVyX2VkaXQgYXJ0aWNsZV9zaG93IHBheXJvbGxfZW1wbG95ZWVfZWRpdCBsZWFkX3Nob3cga2JfYmlsbF9lZGl0IGtiX2V4cGVuc2Vfc2hvdyBrYl9vcmRlcl9zaG93IGtiX2RlbGl2ZXJ5X2VkaXQgYmFua19wYXltZW50X3Nob3cgZmluYW5jZV9yZXBvcnRzIG5vdGVfc2hvdyBzdG9ja19lZGl0IGxlYWRfZWRpdCBrYl9kZWxpdmVyeV9zaG93IHN1YnNjcmlwdGlvbl9hbmRfcGVybWlzc2lvbnMgbm90ZV9lZGl0IGFydGljbGVfZWRpdCBjb250YWN0X2VkaXQgcGF5cm9sbF9hYnNlbmNlX3Nob3cga2JfYXJ0aWNsZV9vcmRlcl9lZGl0IHRhc2tfZWRpdCBwcm9qZWN0X3Nob3ciLCJsb2dpbl9pZCI6IjhlMjAzOTY0LWFhNjktNGE0NC05MzhlLTk0MWQ5MDY2MjU0OSIsImNvbXBhbnlfaWQiOiJ6OGMydXd5ZnJzYWIiLCJ1c2VyX2lkIjo0MjU2MTIsImNvbXBhbnlfdXNlcl9pZCI6MX0.i7kMcQrBIpV_FpAg05vg8EOLjy_R64B8WKzF4N9N-00lfQ82NMpFe2r60kZqumtZyMUwBsPhx634lIeZFF6N7jVxa5m91o5YCOLBI00uIziMe1ZWsRar51tXfF6wJAZFyXDwrZ9j83Pgec9PsjI21cYzjnlX8mZomnb6K6os00hgD3vz8fplOdUXC0mKpro5yitVjXYaDH7bdHlek25aTDJsX0ma6F_oWbrG2pthxRNCS-zpdy3nwvhCeNJJdGfhx8aW2fyGxpyH_1buxurNkHAWD1PX0W78lWqxaR3Gt-oQYrFm02MCOxHYArp9rzPCjOUfxzhzZ_N_L9nDjegKsg";

    public function __construct(
        protected ?string $apiToken = null,
    )
    {
    }

    public function resolveBaseUrl(): string
    {
        return 'https://api.bexio.com';
    }

    protected function defaultAuth(): TokenAuthenticator
    {
        return new TokenAuthenticator($this->apiToken);
    }

    public static function testAccount(): static
    {
        return new self(self::PUBLIC_TEST_API_KEY);
    }
}